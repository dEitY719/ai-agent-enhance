# LangGraph를 활용한 AI 에이전트 구축 브리핑 문서
이 문서는 LangGraph를 사용하여 복잡한 AI 에이전트 및 워크플로우를 구축하는 과정의 주요 내용과 핵심 아이디어를 요약한 것입니다.

## 1. LangGraph 기본 개념 및 구성 요소
LangGraph는 고급 대화형 AI 워크플로우를 구축하기 위한 강력한 Python 라이브러리이며, 그래프 기반 접근 방식을 사용하여 복잡한 대화 시스템을 설계, 구현 및 관리합니다.

- 상태 (State): 애플리케이션의 현재 정보나 컨텍스트를 저장하는 공유 데이터 구조입니다. 노드가 실행될 때 접근하고 수정할 수 있는 변수 및 데이터를 추적하는 "애플리케이션의 메모리" 역할을 합니다.
    > 비유: 회의실의 화이트보드

- 노드 (Node): 그래프 내에서 특정 작업을 수행하는 개별 함수 또는 작업입니다. 노드는 일반적으로 애플리케이션의 현재 상태를 입력으로 받아 처리하고, 출력 또는 업데이트된 상태를 생성합니다.
    > 비유: 조립 라인 스테이션

- 그래프 (Graph): 노드가 어떻게 연결되고 실행되는지 매핑하는 전체적인 구조입니다. 워크플로우를 시각적으로 나타내며, 다양한 작업 간의 순서와 조건부 경로를 보여줍니다.
    > 비유: 도로 지도

- 엣지 (Edge): 노드 간의 연결이며, 실행 흐름을 결정합니다. 현재 노드가 작업을 완료한 후 어떤 노드가 다음에 실행되어야 하는지 애플리케이션에 알려줍니다.
    > 비유: 기차 선로 (상태는 기차)

- 조건부 엣지 (Conditional Edge): 특정 조건이나 논리에 따라 다음 실행 노드를 결정하는 특수 연결입니다.
    > 비유: 교통 신호등 또는 if-else 문

- 시작점 (Start Point) & 끝점 (End Point): 워크플로우의 시작과 끝을 나타내는 가상 진입점 및 종료점입니다.
    > 비유: 경주 시작/결승선

- 도구 (Tools): 노드가 특정 작업을 수행하기 위해 활용할 수 있는 특수 함수 또는 유틸리티(예: API에서 데이터 가져오기)입니다. 노드의 기능을 향상시킵니다.
    > 노드와 도구의 차이: 노드는 그래프 구조의 일부이며, 도구는 노드 내에서 사용되는 기능입니다.  
    > 비유: 도구 상자의 도구

- 도구 노드 (Tool Node): 도구를 실행하는 것이 주된 역할인 특수 노드입니다.
- 상태 그래프 (State Graph): 그래프 구조를 구축하고 컴파일하는 데 사용되는 핵심 요소입니다. 노드, 엣지, 전체 상태를 관리하여 워크플로우가 통합된 방식으로 작동하고 데이터가 구성 요소 간에 올바르게 흐르도록 합니다.
    > 비유: 건물의 청사진

- 실행 가능 (Runnable): AI 워크플로우 내에서 특정 작업을 수행하는 표준화된 실행 구성 요소입니다. 모듈형 시스템을 구축하는 데 필수적인 구성 요소입니다.
    > 비유: 레고 블록

### 메시지 유형 (Message Types):
- 인간 메시지 (Human Message): 사용자로부터의 입력을 나타냅니다.
- AI 메시지 (AI Message): AI 모델이 생성한 응답을 나타냅니다.
- 시스템 메시지 (System Message): 모델에 지침이나 컨텍스트를 제공하는 데 사용됩니다.
- 도구 메시지 (Tool Message): 도구 사용에 특화된 메시지입니다.
- 함수 메시지 (Function Message): 함수 호출의 결과를 나타냅니다.
- 기본 메시지 (Base Message): LangGraph의 모든 메시지 유형에 대한 기초 클래스입니다.

## 2. Python 타입 어노테이션 활용 (LangGraph에 필수적)
LangGraph는 데이터의 구조와 유형을 명확히 정의하는 데 Python의 타입 어노테이션을 광범위하게 사용합니다. 이는 대규모 프로젝트에서 논리적 오류를 줄이고 디버깅을 용이하게 합니다.

- 타입 딕셔너리 (Type Dictionary): 데이터 구조가 특정 유형과 구조를 갖도록 보장하는 방법입니다. 런타임 오류를 줄이고 가독성을 높입니다.
    > 예: 영화 이름(문자열), 연도(정수)

- 유니온 (Union): 변수가 여러 지정된 데이터 유형 중 하나가 될 수 있음을 나타냅니다. 유연성을 제공하면서 타입 안전성을 유지합니다.
    > 예: x는 정수 또는 부동 소수점

- 옵션 (Optional): 변수가 특정 데이터 유형 또는 None 값을 가질 수 있음을 나타냅니다.
    - **Any**: 변수가 어떤 데이터 유형이든 될 수 있음을 나타냅니다.
    - **람다 함수** (Lambda Function): 작고 익명의 함수를 한 줄로 작성하는 데 사용되는 짧은 구문입니다. 코드를 더 효율적으로 만듭니다.
    - **Annotated**: 변수에 영향을 주지 않고 추가 컨텍스트(메타데이터)를 제공하는 타입 어노테이션입니다.
    - **Sequence**: 채팅 기록에 새 메시지를 추가하는 등 시퀀스에 대한 상태 업데이트를 자동으로 처리하여 목록 조작을 피하는 데 사용됩니다.
    - **Add messages** (Reducer Function): 노드에서 업데이트를 기존 상태와 결합하는 방법을 제어하는 규칙입니다. 상태의 데이터를 집계하고 덮어쓰지 않고 추가하는 데 사용됩니다.

## 3. 핵심 아이디어
- **모듈성 및 확장성**: LangGraph는 그래프 기반 접근 방식을 통해 모듈식이고 확장 가능한 AI 애플리케이션 구축을 용이하게 합니다. 각 노드는 특정 작업을 수행하며, 엣지를 통해 연결되어 복잡한 워크플로우를 형성합니다.
- **상태 관리**의 중요성: 공유 데이터 구조인 '상태'는 애플리케이션의 메모리 역할을 하며, LLM 기반 에이전트가 대화 기록을 유지하거나 도구의 결과를 기억하는 데 필수적입니다.
- **LLM 통합**: LangGraph는 LangChain의 기능을 활용하여 GPT-4o와 같은 대규모 언어 모델을 그래프에 쉽게 통합할 수 있습니다. bind_tools와 같은 기능을 통해 LLM이 특정 도구에 접근하여 활용하도록 지시할 수 있습니다.
- 조건부 로직 및 루프: **조건부 엣지**는 데이터 흐름을 동적으로 제어하며, **루프 로직**은 반복적인 작업을 효율적으로 처리하여 복잡한 에이전트 동작을 가능하게 합니다 (예: React 에이전트의 도구 호출 반복).
- 도구 활용 및 외부 기능 통합: 도구를 통해 LLM은 API 호출, 데이터베이스 조회, 계산 수행 등 외부 기능을 활용할 수 있습니다. 이는 LLM의 추론 및 문제 해결 능력을 크게 확장합니다.
- 인간-AI 협업: Drafter 프로젝트와 같이, LangGraph는 인간의 피드백을 통합하여 AI 에이전트가 반복적으로 작업을 개선하도록 하는 시스템 구축에 활용될 수 있습니다.
- **검색 증강 생성 (RAG)**: LangGraph를 사용하여 LLM의 지식 기반을 외부 문서(예: PDF)로 확장하고, 환각(hallucination)을 줄이며, 보다 정확하고 신뢰할 수 있는 답변을 생성할 수 있습니다. 이는 특히 특정 도메인 지식이 필요한 애플리케이션에서 중요합니다.
- **견고성 및 디버깅**: 타입 어노테이션, 리듀서 함수, 명확한 상태 관리 및 도구 정의는 LangGraph 애플리케이션의 견고성을 높이고 디버깅을 용이하게 합니다.
- LangChain과의 관계: LangGraph는 LangChain 위에 구축되어 LangChain이 제공하는 정교하고 강력한 라이브러리(LLM, 임베딩 모델, 문서 로더 등)를 활용합니다.